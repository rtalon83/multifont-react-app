(this["webpackJsonpmultifont-react-app"]=this["webpackJsonpmultifont-react-app"]||[]).push([[0],{10:function(e){e.exports=JSON.parse('[{"type":"Pixi.js BitmapFont","allowTrim":true,"allowRotation":false,"allowOneFont":true,"allowMultiFont":true,"template":"simplefont.mts","fileExt":"xml"},{"type":"Pixi.js MultiBitmapFont","allowTrim":true,"allowRotation":true,"allowOneFont":false,"allowMultiFont":true,"template":"multifont.mts","fileExt":"xml"}]')},16:function(e,t,a){},21:function(e,t,a){e.exports=a(39)},26:function(e,t,a){},27:function(e,t,a){},28:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),r=a(1),s=a.n(r),o=a(5),h=a(2),c=a(3),l=a(4),u=a(7),d=a(6),p=a(12),f=a.n(p),m="ATLAS_LIST_CHANGED",g="PACK_COMPLETED",v="PACK_OPTIONS_CHANGED",b="START_EXPORT",y="FONT_SELECTED",k="CHAR_SELECTED",x="UPDATE_RESULT",w="BACKGROUND_TEXTURE_CHANGED",O=new f.a,_=(a(26),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"header-title"},n.a.createElement("img",{src:"images/logo_app.png",alt:"logo"}),n.a.createElement("div",{className:"title"},"MultiFont Packer BETA 0.1.3")))}}]),a}(i.Component)),S=(a(16),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).onViewClick=i.onViewClick.bind(Object(l.a)(i)),i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateView()}},{key:"componentDidUpdate",value:function(){this.updateView()}},{key:"updateView",value:function(){var e=s.a.findDOMNode(this.refs.view);if(e){e.width=this.props.buffer.width,e.height=this.props.buffer.height,e.style.width=Math.floor(e.width*this.props.scale)+"px",e.style.height=Math.floor(e.height*this.props.scale)+"px";var t=e.getContext("2d");if(t.clearRect(0,0,e.width,e.height),this.props.selectedChar&&(t.globalAlpha=.35),t.drawImage(this.props.buffer,0,0,e.width,e.height,0,0,e.width,e.height),t.globalAlpha=1,this.props.selectedChar)for(var a in this.props.bitmapfonts)if(this.props.bitmapfonts.hasOwnProperty(a)){var i=this.props.bitmapfonts[a];if(i.characters.hasOwnProperty(this.props.selectedChar)){var n=i.characters[this.props.selectedChar],r=n.frame,o=r.w,h=r.h;n.rotated&&(o=r.h,h=r.w),t.clearRect(r.x,r.y,o,h),t.drawImage(this.props.buffer,r.x,r.y,o,h,r.x,r.y,o,h),t.beginPath(),t.rect(r.x,r.y,o,h),t.stroke()}}e.className=this.props.textureBack}}},{key:"drawOutline",value:function(e,t){var a=t.frame,i=a.w,n=a.h;t.rotated&&(i=a.h,n=a.w),e.strokeStyle="#00F",e.fillStyle="rgba(0,0,255,0.25)",e.lineWidth=1,e.beginPath(),e.fillRect(a.x,a.y,i,n),e.rect(a.x,a.y,i,n),e.moveTo(a.x,a.y),e.lineTo(a.x+i,a.y+n),e.stroke()}},{key:"getCharByClick",value:function(e,t,a){var i=null;for(var n in e.characters)if(e.characters.hasOwnProperty(n)){var r=e.characters[n],s=r.frame.w,o=r.frame.h;if(r.rotated&&(s=r.frame.h,o=r.frame.w),t>=r.frame.x&&t<r.frame.x+s&&a>=r.frame.y&&a<r.frame.y+o){i=n;break}}return i}},{key:"onViewClick",value:function(e){var t=null,a=this.props.selectedFont,i=s.a.findDOMNode(this.refs.view).getBoundingClientRect(),n=(e.clientX-i.left)/this.props.scale,r=(e.clientY-i.top)/this.props.scale;if(this.props.multifont){for(var o in this.props.bitmapfonts)if(this.props.bitmapfonts.hasOwnProperty(o)){var h=this.getCharByClick(this.props.bitmapfonts[o],n,r);if(h){t=h,a=o;break}}}else{var c=this.getCharByClick(this.props.bitmapfonts[this.props.selectedFont],n,r);c&&(t=c,a=this.props.selectedFont)}return t&&(this.updateView(),O.emit(k,{selectedChar:t,selectedFont:a})),e.preventDefault(),e.stopPropagation(),!1}},{key:"render",value:function(){return n.a.createElement("div",{ref:"back"},n.a.createElement("canvas",{ref:"view",onClick:this.onViewClick}))}}]),a}(n.a.Component)),N=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e))._testMessage="",i.updateResult=i.updateResult.bind(Object(l.a)(i)),O.on(x,i.updateResult),i}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(){this.updateResult()}},{key:"updateResult",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!=this.props.selectedfont&&this.props.bitmapfonts.hasOwnProperty(this.props.selectedfont)){var t=this.props.bitmapfonts[this.props.selectedfont],a=s.a.findDOMNode(this.refs.canvasTextResult),i=a.getContext("2d");a.width=1280,a.height=768,i.clearRect(0,0,a.width,a.height),e&&(this._testMessage=e.currentTarget.value);var n,r=this._testMessage.split(""),o=r.length,h=0,c=0;for(n=0;n<o;n++)if("\n"===r[n])c+=this.props.bitmapfonts[this.props.selectedfont].lineHeight,h=0;else if(" "===r[n])h+=this.props.bitmapfonts[this.props.selectedfont].spaceWidth;else if("\r"===r[n])h+=this.props.bitmapfonts[this.props.selectedfont].tabWidth;else{var l=t.getCharByText(r[n]);if(l){var u=h+l.xoffset,d=c+l.yoffset;i.drawImage(l.image,u,d),h+=l.xadvance}}}}},{key:"render",value:function(){return n.a.createElement("div",{className:"viewer-tester"},n.a.createElement("div",{className:"tester-text"},n.a.createElement("div",{className:"tester-text-info"},"Write here"),n.a.createElement("textarea",{className:"text-area",ref:"text_area",onChange:this.updateResult})),n.a.createElement("div",{className:"tester-view"},n.a.createElement("div",{className:"tester-text-info"},"Background"),n.a.createElement("div",{className:"canvas-text-result"},n.a.createElement("canvas",{ref:"canvasTextResult"}))))}}]),a}(i.Component),C=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).onFontSelected=i.onFontSelected.bind(Object(l.a)(i)),i.onCharSelected=i.onCharSelected.bind(Object(l.a)(i)),i.onCharChanged=i.onCharChanged.bind(Object(l.a)(i)),i.onChangeBackgroundTexture=i.onChangeBackgroundTexture.bind(Object(l.a)(i)),i.blurHandler=i.blurHandler.bind(Object(l.a)(i)),i.state={textureBack:"grid-texture",packResult:null,selectedChar:null,selectedFont:null},O.on(y,i.onFontSelected),O.on(k,i.onCharSelected),O.on(g,i.updateViewer,Object(l.a)(i)),O.on(w,i.onChangeBackgroundTexture),i}return Object(c.a)(a,[{key:"onChangeBackgroundTexture",value:function(e){this.setState({textureBack:e})}},{key:"onCharSelected",value:function(e){this.setState({selectedChar:e.selectedChar,selectedFont:e.selectedFont})}},{key:"onCharChanged",value:function(e){var t=this.props.bitmapfonts[this.state.selectedFont].getCharById(this.state.selectedChar);t&&(t.text=e.currentTarget.value),O.emit(k,{selectedChar:this.state.selectedChar,selectedFont:this.state.selectedFont})}},{key:"onFontSelected",value:function(e){this.setState({selectedFont:e.selectedFont,selectedChar:null})}},{key:"updateViewer",value:function(e){this.state.selectedFont||(this.state.selectedFont=e[0].selectedFont),this.state.selectedChar=null,this.setState({packResult:e})}},{key:"blurHandler",value:function(){this.setState({selectedChar:null})}},{key:"render",value:function(){var e=[],t=0,a=[];if(this.state.packResult){var i,r=Object(o.a)(this.state.packResult);try{for(r.s();!(i=r.n()).done;){var s=i.value;e.push(n.a.createElement(S,{key:"tex-view-"+t,buffer:s.buffer,textureBack:this.state.textureBack,bitmapfonts:this.props.bitmapfonts,scale:1,multifont:s.multifont,selectedChar:this.state.selectedChar,selectedFont:this.state.selectedFont})),t++}}catch(l){r.e(l)}finally{r.f()}}if(this.state.selectedChar)for(var h in this.props.bitmapfonts)if(this.props.bitmapfonts.hasOwnProperty(h)){var c=this.props.bitmapfonts[h].getCharById(this.state.selectedChar);if(c){a.push(n.a.createElement("input",{onChange:this.onCharChanged,key:"id"+this.state.selectedChar,maxLength:"1",id:this.state.selectedChar,defaultValue:c.text,autoFocus:!0,className:"input-letter",style:{left:c.frame.x,top:c.frame.y}}));break}}return n.a.createElement("div",{className:"viewer-main"},n.a.createElement("div",{className:"viewer"},n.a.createElement("div",{className:"result-view-container"},n.a.createElement("div",{className:"viewer-texture"},n.a.createElement("div",{className:"viewer-input",onBlur:this.blurHandler,tabIndex:0},a),e)),n.a.createElement(N,{bitmapfonts:this.props.bitmapfonts,selectedfont:this.state.selectedFont})))}}]),a}(i.Component),E=["image/png","image/jpg","image/jpeg","image/gif"],F=function(){function e(){Object(h.a)(this,e),this._data=null,this._images={},this.onEnd=null,this.checkDone=this.checkDone.bind(this)}return Object(c.a)(e,[{key:"load",value:function(e,t){var a,i=e.length;for(this._data=[],a=0;a<i;a++)this._data.push(e[a]);this.onEnd=t,this.loadNext()}},{key:"loadNext",value:function(){var e=this;if(this._data.length>0){var t=this._data.shift();if(-1!==E.indexOf(t.type)){var a=new Image,i=new FileReader;i.onload=function(i){a.src=i.target.result,a._base64=i.target.result,e._images[t.name]=a,e.loadNext()},i.readAsDataURL(t)}else this.loadNext()}else this.checkDone()}},{key:"checkDone",value:function(){for(var e=!0,t=0,a=Object.keys(this._images);t<a.length;t++){var i=a[t];if(!this._images[i].complete){e=!1;break}}e?this.onEnd(this._images):setTimeout(this.checkDone,50)}}]),e}(),M=(a(27),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).onSelect=i.onSelect.bind(Object(l.a)(i)),i._divSelected=null,i}return Object(c.a)(a,[{key:"onSelect",value:function(e){return O.emit(y,{selectedFont:e.currentTarget.id,selectedChar:null}),e.currentTarget.className="item-wrapper item-selected",this._divSelected&&(this._divSelected.className="item-wrapper"),this._divSelected=e.currentTarget,e.preventDefault(),e.stopPropagation(),!1}},{key:"componentDidUpdate",value:function(){this.props.data&&null==this._divSelected&&(this._divSelected=s.a.findDOMNode(this.refs.it_0),this._divSelected.className="item-wrapper item-selected")}},{key:"render",value:function(){var e=this,t=Object.keys(this.props.data);if(t.length>0){var a=t.map((function(t,a){return n.a.createElement("div",{key:"id_"+a,className:"item-wrapper",id:t,ref:"it_"+a,onClick:e.onSelect},n.a.createElement("div",{className:"item-image-container"},n.a.createElement("img",{className:"item-image",alt:"imagen",src:e.props.data[t].src})),n.a.createElement("div",{className:"item-text-container"},t))}));return n.a.createElement("div",null,a)}return n.a.createElement("span",null)}}]),a}(i.Component)),j=(a(28),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).onFilesDrop=i.onFilesDrop.bind(Object(l.a)(i)),i.onDragOver=i.onDragOver.bind(Object(l.a)(i)),i.onLoadImagesComplete=i.onLoadImagesComplete.bind(Object(l.a)(i)),i.state={atlas:{}},i}return Object(c.a)(a,[{key:"onFilesDrop",value:function(e){(e.preventDefault(),e.dataTransfer.files.length)&&(new F).load(e.dataTransfer.files,this.onLoadImagesComplete);return!1}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onLoadImagesComplete",value:function(e){var t=Object.keys(e);if(t.length){var a,i=this.state.atlas,n=Object(o.a)(t);try{for(n.s();!(a=n.n()).done;){var r=a.value;i[r]=e[r]}}catch(s){n.e(s)}finally{n.f()}this.setState({atlas:i}),O.emit(m,i)}}},{key:"render",value:function(){var e=Object.keys(this.state.atlas).length>0?null:n.a.createElement("div",{ref:"dropHelp",className:"image-drop-help"},"drag'n'drop images here");return n.a.createElement("div",{className:"atlas-list",onDrop:this.onFilesDrop,onDragOver:this.onDragOver},n.a.createElement("div",null,n.a.createElement(M,{data:this.state.atlas}),e))}}]),a}(i.Component)),P={Default:"Default"},T=function(){function e(){Object(h.a)(this,e)}return Object(c.a)(e,[{key:"pack",value:function(){throw Error("Abstarct method. Override it.")}}],[{key:"getMethodProps",value:function(){return{name:"Default",description:"Default placement"}}},{key:"type",get:function(){return"Default"}},{key:"methods",get:function(){return P}}]),e}(),D=a(13),R={Smart:"Smart",SmartArea:"SmartArea",Square:"Square",SquareArea:"SquareArea",SmartSquare:"SmartSquare",SmartSquareArea:"SmartSquareArea"},B=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,i){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(h.a)(this,a),(n=t.call(this)).binWidth=e,n.binHeight=i,n.allowRotate=r,n}return Object(c.a)(a,[{key:"pack",value:function(e,t){var a,i={smart:t===R.Smart||t===R.SmartArea||t===R.SmartSquare||t===R.SmartSquareArea,pot:!1,square:t===R.Square||t===R.SquareArea||t===R.SmartSquare||t===R.SmartSquareArea,allowRotation:this.allowRotate,logic:t===R.Smart||t===R.Square||t===R.SmartSquare?D.b.MAX_EDGE:D.b.MAX_AREA},n=new D.a(this.binWidth,this.binHeight,0,i),r=[],s=Object(o.a)(e);try{for(s.s();!(a=s.n()).done;){var h=a.value;r.push({width:h.frame.w,height:h.frame.h,data:h})}}catch(f){s.e(f)}finally{s.f()}n.addArray(r);var c,l=n.bins[0].rects,u=[],d=Object(o.a)(l);try{for(d.s();!(c=d.n()).done;){var p=c.value;p.data.frame.x=p.x,p.data.frame.y=p.y,p.rot&&(p.data.rotated=!0),u.push(p.data)}}catch(f){d.e(f)}finally{d.f()}return u}}],[{key:"getMethodProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e){case R.Smart:return{name:"Smart edge logic",description:""};case R.SmartArea:return{name:"Smart area logic",description:""};case R.Square:return{name:"Square edge logic",description:""};case R.SquareArea:return{name:"Square area logic",description:""};case R.SmartSquare:return{name:"Smart square edge logic",description:""};case R.SmartSquareArea:return{name:"Smart square area logic",description:""};default:throw Error("Unknown method "+e)}}},{key:"type",get:function(){return"MaxRectsPacker"}},{key:"methods",get:function(){return R}}]),a}(T),z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(h.a)(this,e),this.x=t,this.y=a,this.width=i,this.height=n}return Object(c.a)(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"hitTest",value:function(t){return e.hitTest(this,t)}}],[{key:"hitTest",value:function(e,t){return e.x>=t.x&&e.y>=t.y&&e.x+e.width<=t.x+t.width&&e.y+e.height<=t.y+t.height}}]),e}(),I={BestShortSideFit:"BestShortSideFit",BestLongSideFit:"BestLongSideFit",BestAreaFit:"BestAreaFit",BottomLeftRule:"BottomLeftRule",ContactPointRule:"ContactPointRule"},L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,i){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(h.a)(this,a),(n=t.call(this)).usedRectangles=[],n.freeRectangles=[],n.binWidth=e,n.binHeight=i,n.allowRotate=r,n.freeRectangles.push(new z(0,0,e,i)),n}return Object(c.a)(a,[{key:"pack",value:function(e,t){return this.insert2(e,t)}},{key:"insert",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I.BestShortSideFit,i=new z,n={value:0},r={value:0};switch(a){case I.BestShortSideFit:i=this._findPositionForNewNodeBestShortSideFit(e,t,n,r);break;case I.BottomLeftRule:i=this._findPositionForNewNodeBottomLeft(e,t,n,r);break;case I.ContactPointRule:i=this._findPositionForNewNodeContactPoint(e,t,n);break;case I.BestLongSideFit:i=this._findPositionForNewNodeBestLongSideFit(e,t,r,n);break;case I.BestAreaFit:i=this._findPositionForNewNodeBestAreaFit(e,t,n,r)}return 0===i.height||this._placeRectangle(i),i}},{key:"insert2",value:function(e,t){for(var a=[];e.length>0;){for(var i=1/0,n=1/0,r=-1,s=new z,o=0;o<e.length;o++){var h={value:0},c={value:0},l=this._scoreRectangle(e[o].frame.w,e[o].frame.h,t,h,c);(h.value<i||h.value===i&&c.value<n)&&(i=h.value,n=c.value,s=l,r=o)}if(-1===r)return a;this._placeRectangle(s);var u=e.splice(r,1)[0];u.frame.x=s.x,u.frame.y=s.y,u.frame.w===s.width&&u.frame.h===s.height||(u.rotated=!0),a.push(u)}return a}},{key:"_placeRectangle",value:function(e){for(var t=this.freeRectangles.length,a=0;a<t;a++)this._splitFreeNode(this.freeRectangles[a],e)&&(this.freeRectangles.splice(a,1),a--,t--);this._pruneFreeList(),this.usedRectangles.push(e)}},{key:"_scoreRectangle",value:function(e,t,a,i,n){var r=new z;switch(i.value=1/0,n.value=1/0,a){case I.BestShortSideFit:r=this._findPositionForNewNodeBestShortSideFit(e,t,i,n);break;case I.BottomLeftRule:r=this._findPositionForNewNodeBottomLeft(e,t,i,n);break;case I.ContactPointRule:r=this._findPositionForNewNodeContactPoint(e,t,i),i.value=-i.value;break;case I.BestLongSideFit:r=this._findPositionForNewNodeBestLongSideFit(e,t,n,i);break;case I.BestAreaFit:r=this._findPositionForNewNodeBestAreaFit(e,t,i,n)}return 0===r.height&&(i.value=1/0,n.value=1/0),r}},{key:"_occupancy",value:function(){for(var e=this.usedRectangles,t=0,a=0;a<e.length;a++)t+=e[a].width*e[a].height;return t/(this.binWidth*this.binHeight)}},{key:"_findPositionForNewNodeBottomLeft",value:function(e,t,a,i){var n,r,s=this.freeRectangles,o=new z;a.value=1/0;for(var h=0;h<s.length;h++)(n=s[h]).width>=e&&n.height>=t&&((r=n.y+t)<a.value||r===a.value&&n.x<i.value)&&(o.x=n.x,o.y=n.y,o.width=e,o.height=t,a.value=r,i.value=n.x),this.allowRotate&&n.width>=t&&n.height>=e&&((r=n.y+e)<a.value||r===a.value&&n.x<i.value)&&(o.x=n.x,o.y=n.y,o.width=t,o.height=e,a.value=r,i.value=n.x);return o}},{key:"_findPositionForNewNodeBestShortSideFit",value:function(e,t,a,i){var n,r,s,o,h,c=this.freeRectangles,l=new z;a.value=1/0;for(var u=0;u<c.length;u++){(n=c[u]).width>=e&&n.height>=t&&(r=Math.abs(n.width-e),s=Math.abs(n.height-t),o=Math.min(r,s),h=Math.max(r,s),(o<a.value||o===a.value&&h<i.value)&&(l.x=n.x,l.y=n.y,l.width=e,l.height=t,a.value=o,i.value=h));var d=void 0,p=void 0,f=void 0,m=void 0;this.allowRotate&&n.width>=t&&n.height>=e&&(d=Math.abs(n.width-t),p=Math.abs(n.height-e),f=Math.min(d,p),m=Math.max(d,p),(f<a.value||f===a.value&&m<i.value)&&(l.x=n.x,l.y=n.y,l.width=t,l.height=e,a.value=f,i.value=m))}return l}},{key:"_findPositionForNewNodeBestLongSideFit",value:function(e,t,a,i){var n,r,s,o,h,c=this.freeRectangles,l=new z;i.value=1/0;for(var u=0;u<c.length;u++)(n=c[u]).width>=e&&n.height>=t&&(r=Math.abs(n.width-e),s=Math.abs(n.height-t),o=Math.min(r,s),((h=Math.max(r,s))<i.value||h===i.value&&o<a.value)&&(l.x=n.x,l.y=n.y,l.width=e,l.height=t,a.value=o,i.value=h)),this.allowRotate&&n.width>=t&&n.height>=e&&(r=Math.abs(n.width-t),s=Math.abs(n.height-e),o=Math.min(r,s),((h=Math.max(r,s))<i.value||h===i.value&&o<a.value)&&(l.x=n.x,l.y=n.y,l.width=t,l.height=e,a.value=o,i.value=h));return l}},{key:"_findPositionForNewNodeBestAreaFit",value:function(e,t,a,i){var n,r,s,o,h,c=this.freeRectangles,l=new z;a.value=1/0;for(var u=0;u<c.length;u++)h=(n=c[u]).width*n.height-e*t,n.width>=e&&n.height>=t&&(r=Math.abs(n.width-e),s=Math.abs(n.height-t),o=Math.min(r,s),(h<a.value||h===a.value&&o<i.value)&&(l.x=n.x,l.y=n.y,l.width=e,l.height=t,i.value=o,a=h)),this.allowRotate&&n.width>=t&&n.height>=e&&(r=Math.abs(n.width-t),s=Math.abs(n.height-e),o=Math.min(r,s),(h<a.value||h===a.value&&o<i.value)&&(l.x=n.x,l.y=n.y,l.width=t,l.height=e,i.value=o,a.value=h));return l}},{key:"_commonIntervalLength",value:function(e,t,a,i){return t<a||i<e?0:Math.min(t,i)-Math.max(e,a)}},{key:"_contactPointScoreNode",value:function(e,t,a,i){var n,r=this.usedRectangles,s=0;0!==e&&e+a!==this.binWidth||(s+=i),0!==t&&t+i!==this.binHeight||(s+=a);for(var o=0;o<r.length;o++)(n=r[o]).x!==e+a&&n.x+n.width!==e||(s+=this._commonIntervalLength(n.y,n.y+n.height,t,t+i)),n.y!==t+i&&n.y+n.height!==t||(s+=this._commonIntervalLength(n.x,n.x+n.width,e,e+a));return s}},{key:"_findPositionForNewNodeContactPoint",value:function(e,t,a){var i,n,r=this.freeRectangles,s=new z;a.value=-1;for(var o=0;o<r.length;o++)(i=r[o]).width>=e&&i.height>=t&&(n=this._contactPointScoreNode(i.x,i.y,e,t))>a.value&&(s.x=i.x,s.y=i.y,s.width=e,s.height=t,a=n),this.allowRotate&&i.width>=t&&i.height>=e&&(n=this._contactPointScoreNode(i.x,i.y,t,e))>a.value&&(s.x=i.x,s.y=i.y,s.width=t,s.height=e,a.value=n);return s}},{key:"_splitFreeNode",value:function(e,t){var a,i=this.freeRectangles;return!(t.x>=e.x+e.width||t.x+t.width<=e.x||t.y>=e.y+e.height||t.y+t.height<=e.y)&&(t.x<e.x+e.width&&t.x+t.width>e.x&&(t.y>e.y&&t.y<e.y+e.height&&((a=e.clone()).height=t.y-a.y,i.push(a)),t.y+t.height<e.y+e.height&&((a=e.clone()).y=t.y+t.height,a.height=e.y+e.height-(t.y+t.height),i.push(a))),t.y<e.y+e.height&&t.y+t.height>e.y&&(t.x>e.x&&t.x<e.x+e.width&&((a=e.clone()).width=t.x-a.x,i.push(a)),t.x+t.width<e.x+e.width&&((a=e.clone()).x=t.x+t.width,a.width=e.x+e.width-(t.x+t.width),i.push(a))),!0)}},{key:"_pruneFreeList",value:function(){for(var e=this.freeRectangles,t=0;t<e.length;t++)for(var a=t+1;a<e.length;a++){if(z.hitTest(e[t],e[a])){e.splice(t,1);break}z.hitTest(e[a],e[t])&&e.splice(a,1)}}}],[{key:"getMethodProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e){case I.BestShortSideFit:return{name:"Best short side fit",description:"Positions the Rectangle against the short side of a free Rectangle into which it fits the best."};case I.BestLongSideFit:return{name:"Best long side fit",description:"Positions the Rectangle against the long side of a free Rectangle into which it fits the best."};case I.BestAreaFit:return{name:"Best area fit",description:"Positions the Rectangle into the smallest free Rectangle into which it fits."};case I.BottomLeftRule:return{name:"Bottom left rule",description:"Does the Tetris placement."};case I.ContactPointRule:return{name:"Contact point rule",description:"Choosest the placement where the Rectangle touches other Rectangles as much as possible."};default:throw Error("Unknown method "+e)}}},{key:"type",get:function(){return"MaxRectsBin"}},{key:"methods",get:function(){return I}}]),a}(T),A={Automatic:"Automatic"},V=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,i){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(h.a)(this,a),t.call(this)}return Object(c.a)(a,[{key:"pack",value:function(e,t){throw new Error("OptimalPacker is a dummy and cannot be used directly")}}],[{key:"getMethodProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e){case A.Automatic:return{name:"Automatic",description:""};default:throw Error("Unknown method "+e)}}},{key:"type",get:function(){return"OptimalPacker"}},{key:"methods",get:function(){return A}}]),a}(T),H=[L,B,V];function W(e){var t,a=Object(o.a)(H);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.type===e)return i}}catch(n){a.e(n)}finally{a.f()}return null}var q=H,U=["grid-texture","white-texture","pink-texture","black-texture"],G=a(10),X=a(14),K=a.n(X),J=a(17);function Y(e){var t=e||"";if(t&&"string"!==typeof t){t=[];for(var a=0,i=Object.keys(e);a<i.length;a++){var n=i[a];t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e[n])))}t=t.join("&")}return t}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=window.XMLHttpRequest&&new XMLHttpRequest||null;return n&&(n.onreadystatechange=function(){if(4===n.readyState){var r=null;n.status<400?("arraybuffer"===i&&(r=n.response),"xml"===i&&(r=n.responseXML),!r&&n.responseText&&(r=n.responseText),t&&t(r)):a&&a("".concat(e," HTTP Error ").concat(n.status,": ").concat(n.statusText))}}),n}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"text",s=Z(e,i,n,r);if(s){var o=Y(a);"GET"==t&&o&&(e+="?"+o),s.open(t,e,!0),"arraybuffer"==r&&(s.responseType="arraybuffer"),"POST"==t&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send("GET"==t?null:o)}}var $=a(18),ee=a(19),te=a.n(ee),ae=a(20),ie=a.n(ae),ne={CODE:32,ID:"space"},re={CODE:9,ID:"tab"},se=function(){function e(){Object(h.a)(this,e)}return Object(c.a)(e,null,[{key:"parseChar",value:function(e){var t=null;switch(e.code){case ne.CODE:case re.CODE:t={letter:e.letter,code:e.code,x:0,y:0,width:0,height:0,xoffset:0,yoffset:0,xadvance:e.xadvance};break;default:t={letter:e.text,code:e.code,x:e.frame.x,y:e.frame.y,width:e.frame.w,height:e.frame.h,xoffset:e.xoffset,yoffset:e.yoffset,xadvance:e.xadvance}}return t}},{key:"parseFont",value:function(e,t){var a={name:e.name,size:e.size,lineHeight:e.lineHeight,scaleW:t.width,scaleH:t.height,num_pages:0,pages:[{id_page:0,file_name:t.textureName+"."+t.textureFormat}]},i=Object.keys(e.characters);for(var n in a.chars_count=i.length,a.chars=[],e.characters)a.chars.push(this.parseChar(e.characters[n]));return a.chars.push(this.parseChar({code:ne.CODE,letter:ne.ID,xadvance:e.spaceWidth})),a.chars.push(this.parseChar({code:re.CODE,letter:re.ID,xadvance:e.tabWidth})),a.kernings_count=0,a.kernings=[],a}},{key:"parseMultiFont",value:function(e,t){var a={scaleW:t.width,scaleH:t.height,file_name:t.textureName+"."+t.textureFormat,fonts:[]};for(var i in e)if(e.hasOwnProperty(i)){var n={name:e[i].name,size:e[i].size,lineHeight:e[i].lineHeight},r=Object.keys(e[i].characters);for(var s in n.chars_count=r.length,n.chars=[],e[i].characters)n.chars.push(this.parseChar(e[i].characters[s]));n.chars.push(this.parseChar({code:ne.CODE,letter:ne.ID,xadvance:e[i].spaceWidth})),n.chars.push(this.parseChar({code:re.CODE,letter:re.ID,xadvance:e[i].tabWidth})),n.kernings_count=0,n.kernings=[],a.fonts.push(n)}return a}}]),e}(),oe=function(){function e(){Object(h.a)(this,e)}return Object(c.a)(e,null,[{key:"getExporterByType",value:function(e){var t,a=Object(o.a)(G);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.type===e)return i}}catch(n){a.e(n)}finally{a.f()}return null}},{key:"startExporter",value:function(){var e=Object(J.a)(K.a.mark((function e(t,a,i){var n,r,s,o,h,c,l,u,d,p,f,m,g,v;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],r="exporters/"+i.exporter.template,s=[],"Pixi.js BitmapFont"===i.exporter.type)if(i.multiFont)for(o in a)a.hasOwnProperty(o)&&s.push(se.parseFont(a[o],{width:t.width,height:t.height,textureName:i.textureName,textureFormat:i.textureFormat}));else s.push(se.parseFont(a[i.selectedFont],{width:t.width,height:t.height,textureName:i.textureName,textureFormat:i.textureFormat}));else"Pixi.js MultiBitmapFont"===i.exporter.type&&s.push(se.parseMultiFont(a,{width:t.width,height:t.height,textureName:i.textureName,textureFormat:i.textureFormat}));e.prev=4,c=[],l=s.length,h=0;case 8:if(!(h<l)){e.next=17;break}return e.t0=c,e.next=12,this.loadTemplate(s[h],r);case 12:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 14:h++,e.next=8;break;case 17:if(u=t.toDataURL("png"===i.textureFormat?"image/png":"image/jpeg"),(d=u.split(",")).shift(),u=d.join(","),n.push({name:i.textureName+"."+i.textureFormat,content:u,base64:!0}),c.length>1)for(p in c)c.hasOwnProperty(p)&&n.push({name:i.textureName+"_"+p+".xml",content:c[p]});else n.push({name:i.textureName+".xml",content:c[0]});for(f=new te.a,m=0,g=n;m<g.length;m++)v=g[m],f.file(v.name,v.content,{base64:!!v.base64});f.generateAsync({type:"blob"}).then((function(e){ie.a.saveAs(e,i.fileName+".zip")})),e.next=30;break;case 28:e.prev=28,e.t2=e.catch(4);case 30:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(t,a,i){return e.apply(this,arguments)}}()},{key:"loadTemplate",value:function(e,t){var a=this;return new Promise((function(i,n){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"text";Q(e,"GET",t,a,i,n)}(t,null,(function(t){a.renderTemplate(t,e,i,n)}),(function(){return n("multifont.mts not found")}))}))}},{key:"renderTemplate",value:function(e,t,a,i){try{a($.a.render(e,t))}catch(n){i(n.message)}}}]),e}(),he=(a(37),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).changeTab=i.changeTab.bind(Object(l.a)(i)),i.toggleChange=i.toggleChange.bind(Object(l.a)(i)),i.onFontPropChanged=i.onFontPropChanged.bind(Object(l.a)(i)),i.onPackerChange=i.onPackerChange.bind(Object(l.a)(i)),i.startExport=i.startExport.bind(Object(l.a)(i)),i.onFontSelected=i.onFontSelected.bind(Object(l.a)(i)),i.onCharSelected=i.onCharSelected.bind(Object(l.a)(i)),i.setBack=i.setBack.bind(Object(l.a)(i)),i.onToggleSwitchChange=i.onToggleSwitchChange.bind(Object(l.a)(i)),i.onExporterChanged=i.onExporterChanged.bind(Object(l.a)(i)),i.onDimChanged=i.onDimChanged.bind(Object(l.a)(i)),i.methodItems=null,i.packOptions=i.setPackDefault(),i.updatePackerMethods(),i.state={multiTexture:!1,textureBack:"grid-back",packer:i.packOptions.packer,selectedFont:"",selectedChar:""},O.on(y,i.onFontSelected),O.on(k,i.onCharSelected),i}return Object(c.a)(a,[{key:"onExporterChanged",value:function(e){var t=oe.getExporterByType(s.a.findDOMNode(this.refs.exporter).value);s.a.findDOMNode(this.refs.allowRotation).disabled=!t.allowRotation,s.a.findDOMNode(this.refs.allowTrim).disabled=!t.allowTrim,s.a.findDOMNode(this.refs.trimmode).disabled=!t.allowTrim,s.a.findDOMNode(this.refs.toggleSwitch).disabled=!(t.allowMultiFont&&t.allowOneFont),s.a.findDOMNode(this.refs.toggleSwitch).disabled&&(s.a.findDOMNode(this.refs.toggleSwitch).checked=t.allowMultiFont),this.packOptions.exporter=t,this.packOptions.allowTrim=t.allowTrim,this.packOptions.allowRotation=t.allowRotation,this.emitChanges()}},{key:"onFontSelected",value:function(e){this.state.selectedFont=e.selectedFont,this.updateFontProps()}},{key:"onCharSelected",value:function(e){this.state.selectedChar=e.selectedChar,this.state.selectedFont=e.selectedFont,this.updateFontProps()}},{key:"updateFontProps",value:function(){if(this.state.selectedFont){this.packOptions.selectedFont=this.state.selectedFont;var e=this.props.bitmapfonts[this.state.selectedFont];s.a.findDOMNode(this.refs.bmpfSelected).value=this.state.selectedFont,s.a.findDOMNode(this.refs.size).value=e.size,s.a.findDOMNode(this.refs.lineHeight).value=e.lineHeight,s.a.findDOMNode(this.refs.spaceWidth).value=e.spaceWidth,s.a.findDOMNode(this.refs.tabWidth).value=e.tabWidth,s.a.findDOMNode(this.refs.monoSpace).checked=e.monospace;var t=e.getCharById(this.state.selectedChar);t?(s.a.findDOMNode(this.refs.selectedChar).value=t.text,s.a.findDOMNode(this.refs.asciiCode).value=t.code,s.a.findDOMNode(this.refs.xOffSet).value=t.xoffset,s.a.findDOMNode(this.refs.yOffSet).value=t.yoffset,s.a.findDOMNode(this.refs.xAdvance).value=t.xadvance):(s.a.findDOMNode(this.refs.xOffSet).value=0,s.a.findDOMNode(this.refs.yOffSet).value=0,s.a.findDOMNode(this.refs.xAdvance).value=0)}}},{key:"emitChanges",value:function(){var e=Object.assign({},this.packOptions);e.packer=W(e.packer),O.emit(v,e)}},{key:"setPackDefault",value:function(){var e={selectedFont:null,multiFont:!1};return e.exporter=G[0],e.fileName="pack-result",e.textureName="texture",e.textureFormat="png",e.scale=1,e.width=2048,e.height=2048,e.fixedSize=!1,e.powerOfTwo=!1,e.allowRotation=!1,e.allowTrim=!1,e.trimMode="trim",e.detectIdentical=!0,e.packer=q[0].type,e.packerMethod=Object.keys(q[0].methods)[0],e}},{key:"componentDidMount",value:function(){document.getElementById("id_button_pack").click(),this.emitChanges()}},{key:"changeTab",value:function(e){if("id_button_pack"===e.currentTarget.id){s.a.findDOMNode(this.refs.tab_font).style.display="none",s.a.findDOMNode(this.refs.tab_properties).style.display="block",s.a.findDOMNode(this.refs.tab_button_pack).className+=" active";var t=s.a.findDOMNode(this.refs.tab_button_font);t.className=t.className.replace(" active","")}else{s.a.findDOMNode(this.refs.tab_font).style.display="block",s.a.findDOMNode(this.refs.tab_properties).style.display="none",s.a.findDOMNode(this.refs.tab_button_font).className+=" active";var a=s.a.findDOMNode(this.refs.tab_button_pack);a.className=a.className.replace(" active","")}}},{key:"updatePackerMethods",value:function(){var e=W(this.packOptions.packer);e||(e=q[0]),this.methodItems=[];for(var t=Object.keys(e.methods),a=0,i=t;a<i.length;a++){var r=i[a];this.methodItems.push(n.a.createElement("option",{value:r,key:"packer-method-"+r},r))}this.packOptions.packerMethod=t[0]}},{key:"onPackerChange",value:function(e){this.packOptions.packer=s.a.findDOMNode(this.refs.packer).value,this.updatePackerMethods(),this.setState({packer:this.packOptions.packer}),this.emitChanges()}},{key:"onFontPropChanged",value:function(e){(this.props.bitmapfonts[this.state.selectedFont].size=Number(s.a.findDOMNode(this.refs.size).value),this.props.bitmapfonts[this.state.selectedFont].lineHeight=Number(s.a.findDOMNode(this.refs.lineHeight).value),this.props.bitmapfonts[this.state.selectedFont].spaceWidth=Number(s.a.findDOMNode(this.refs.spaceWidth).value),this.props.bitmapfonts[this.state.selectedFont].tabWidth=Number(s.a.findDOMNode(this.refs.tabWidth).value),this.props.bitmapfonts[this.state.selectedFont].monospace=s.a.findDOMNode(this.refs.monoSpace).checked,this.props.bitmapfonts[this.state.selectedFont].monospace)?this.props.bitmapfonts[this.state.selectedFont].setCharMonospace():this.props.bitmapfonts[this.state.selectedFont].getCharById(this.state.selectedChar)&&(this.props.bitmapfonts[this.state.selectedFont].characters[this.state.selectedChar].xoffset=Number(s.a.findDOMNode(this.refs.xOffSet).value),this.props.bitmapfonts[this.state.selectedFont].characters[this.state.selectedChar].yoffset=Number(s.a.findDOMNode(this.refs.yOffSet).value),this.props.bitmapfonts[this.state.selectedFont].characters[this.state.selectedChar].xadvance=Number(s.a.findDOMNode(this.refs.xAdvance).value));O.emit(x)}},{key:"toggleChange",value:function(e){this.packOptions.fileName=s.a.findDOMNode(this.refs.fileName).value,this.packOptions.textureFormat=s.a.findDOMNode(this.refs.textureFormat).value,this.packOptions.textureName=s.a.findDOMNode(this.refs.textureName).value,this.packOptions.scale=s.a.findDOMNode(this.refs.scale).value,this.packOptions.width=s.a.findDOMNode(this.refs.width).value,this.packOptions.height=s.a.findDOMNode(this.refs.height).value,this.packOptions.fixedSize=s.a.findDOMNode(this.refs.fixedSize).checked,this.packOptions.powerOfTwo=s.a.findDOMNode(this.refs.powerOfTwo).checked,this.packOptions.detectIdentical=s.a.findDOMNode(this.refs.detectIdentical).checked,this.packOptions.allowTrim=s.a.findDOMNode(this.refs.allowTrim).checked,this.packOptions.allowRotation=s.a.findDOMNode(this.refs.allowRotation).checked,this.packOptions.packer=s.a.findDOMNode(this.refs.packer).value,this.packOptions.packerMethod=s.a.findDOMNode(this.refs.packerMethod).value,this.emitChanges()}},{key:"startExport",value:function(){O.emit(b)}},{key:"setBack",value:function(e){var t=e.target.className.split(" ");O.emit(w,t[1])}},{key:"onToggleSwitchChange",value:function(e){this.packOptions.multiFont=e.currentTarget.checked,this.emitChanges()}},{key:"onDimChanged",value:function(e){e&&(13===(e.keyCode||e.which)&&(""===e.currentTarget.value&&(e.currentTarget.value=1),this.toggleChange()))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"properties"},n.a.createElement("div",{className:"tabs"},n.a.createElement("div",{className:"tab"},n.a.createElement("button",{ref:"tab_button_pack",id:"id_button_pack",className:"tab-button",onClick:this.changeTab},"Pack Properties"),n.a.createElement("button",{ref:"tab_button_font",id:"id_button_font",className:"tab-button",onClick:this.changeTab},"Font Properties")),n.a.createElement("div",{ref:"tab_properties",className:"tab-content"},n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Pack Name"),n.a.createElement("input",{className:"properties-input-field",ref:"fileName",defaultValue:this.packOptions.fileName})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Texture Name"),n.a.createElement("input",{className:"properties-input-field",ref:"textureName",defaultValue:this.packOptions.textureName})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Format"),n.a.createElement("select",{className:"properties-input-field",ref:"textureFormat",defaultValue:this.packOptions.textureFormat,onChange:this.toggleChange},n.a.createElement("option",{value:"png"},"png"),n.a.createElement("option",{value:"jpg"},"jpg"))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Exporter"),n.a.createElement("select",{className:"properties-input-field",ref:"exporter",onChange:this.onExporterChanged,defaultValue:this.packOptions.exporter},G.map((function(e){return n.a.createElement("option",{key:"exporter-"+e.type,defaultValue:e.type},e.type)})))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Scale"),n.a.createElement("input",{className:"properties-input-field",ref:"scale",defaultValue:this.packOptions.scale})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Width"),n.a.createElement("input",{className:"properties-input-field",ref:"width",type:"number",min:"0",onKeyDown:this.onDimChanged,defaultValue:this.packOptions.width})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Height"),n.a.createElement("input",{className:"properties-input-field",ref:"height",type:"number",min:"0",onKeyDown:this.onDimChanged,defaultValue:this.packOptions.height})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Fixed size"),n.a.createElement("label",{className:"checkbox-container"},n.a.createElement("input",{type:"checkbox",ref:"fixedSize",defaultChecked:this.packOptions.fixedSize?"checked":"",onChange:this.toggleChange}),n.a.createElement("span",{className:"checkmark"}))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Power of two"),n.a.createElement("label",{className:"checkbox-container"},n.a.createElement("input",{type:"checkbox",ref:"powerOfTwo",onChange:this.toggleChange,defaultChecked:this.packOptions.powerOfTwo?"checked":""}),n.a.createElement("span",{className:"checkmark"}))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Allow Rotation"),n.a.createElement("label",{className:"checkbox-container"},n.a.createElement("input",{type:"checkbox",ref:"allowRotation",disabled:!this.packOptions.exporter.allowRotation,onChange:this.toggleChange,defaultChecked:this.packOptions.allowRotation?"checked":""}),n.a.createElement("span",{className:"checkmark"}))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Allow Trim"),n.a.createElement("label",{className:"checkbox-container"},n.a.createElement("input",{type:"checkbox",ref:"allowTrim",onChange:this.toggleChange,disabled:!this.packOptions.exporter.allowTrim,defaultChecked:this.packOptions.allowTrim?"checked":""}),n.a.createElement("span",{className:"checkmark"}))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Trim mode"),n.a.createElement("select",{className:"properties-input-field",ref:"trimmode"},n.a.createElement("option",{value:"trim"},"Trim"),n.a.createElement("option",{value:"crop"},"Crop"))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Detect identical"),n.a.createElement("label",{className:"checkbox-container"},n.a.createElement("input",{type:"checkbox",ref:"detectIdentical",onChange:this.toggleChange,defaultChecked:this.packOptions.detectIdentical?"checked":""}),n.a.createElement("span",{className:"checkmark"}))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Packer"),n.a.createElement("select",{className:"properties-input-field",ref:"packer",onChange:this.onPackerChange},q.map((function(e){return n.a.createElement("option",{key:"packer-"+e.type,defaultValue:e.type},e.type)})))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Method"),n.a.createElement("select",{className:"properties-input-field",ref:"packerMethod",onChange:this.toggleChange,disabled:"OptimalPacker"===this.packOptions.packer},this.methodItems)),n.a.createElement("div",{className:"bg-texture-container"},"Background texture",n.a.createElement("div",{className:"bg-texture-container-buttons"},U.map((function(t){return n.a.createElement("div",{key:"bg-texture-"+t},n.a.createElement("div",{className:"bg-texture-button "+t+(e.state.textureBack===t?" selected":""),onClick:e.setBack},"\xa0"))})))),n.a.createElement("div",{className:"bg-texture-container properties-input properties-switch"},n.a.createElement("div",{className:"properties-switch-op"},"One Font"),n.a.createElement("div",null,n.a.createElement("label",{className:"switch"},n.a.createElement("input",{type:"checkbox",ref:"toggleSwitch",onClick:this.onToggleSwitchChange}),n.a.createElement("span",{className:"slider round"}))),n.a.createElement("div",{className:"properties-switch-op"},"Multi Font"))),n.a.createElement("div",{ref:"tab_font",className:"tab-content"},n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"BitmapFont"),n.a.createElement("input",{className:"properties-input-field",ref:"bmpfSelected",defaultValue:"",readOnly:!0,disabled:!0})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Monospace"),n.a.createElement("label",{className:"checkbox-container"},n.a.createElement("input",{type:"checkbox",ref:"monoSpace",onChange:this.onFontPropChanged}),n.a.createElement("span",{className:"checkmark"}))),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Font size"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"size",defaultValue:"0",onChange:this.onFontPropChanged})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Line height"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"lineHeight",defaultValue:"0",onChange:this.onFontPropChanged})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Space width"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"spaceWidth",defaultValue:"0",onChange:this.onFontPropChanged})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Tab width"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"tabWidth",defaultValue:"0",onChange:this.onFontPropChanged})),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"Selected Char"),n.a.createElement("input",{className:"properties-input-field",ref:"selectedChar",defaultValue:"",readOnly:!0,disabled:!0})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"ASCII Code"),n.a.createElement("input",{className:"properties-input-field",ref:"asciiCode",defaultValue:"",readOnly:!0,disabled:!0})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"xoffset"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"xOffSet",defaultValue:"0",onChange:this.onFontPropChanged})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"yoffset"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"yOffSet",defaultValue:"0",onChange:this.onFontPropChanged})),n.a.createElement("div",{className:"properties-input"},n.a.createElement("span",{className:"properties-input-item"},"xadvance"),n.a.createElement("input",{className:"properties-input-field",type:"number",ref:"xAdvance",defaultValue:"0",onChange:this.onFontPropChanged})))),n.a.createElement("div",null,n.a.createElement("button",{className:"app-button",ref:"exportButton",onClick:this.startExport},"EXPORT")))}}]),a}(i.Component)),ce=a(41),le=function(){function e(){Object(h.a)(this,e),this._listSelections=null,this._img=null,this._rawData=null,this._refPixel=null,this._fontName=null,this._auxCanvas=document.createElement("canvas")}return Object(c.a)(e,[{key:"split",value:function(e,t){this._listSelections=[],this._img=e,this._fontName=t,this._auxCanvas.width=e.width,this._auxCanvas.height=e.height,this._auxCanvas.getContext("2d").drawImage(e,0,0,e.width,e.height),this._rawData=this._auxCanvas.getContext("2d").getImageData(0,0,e.width,e.height).data,this._refPixel=this.getPixel(0,0);var a=!0;do{a=this.selectFrameAt()}while(a);return this._listSelections}},{key:"selectFrameAt",value:function(){var e=this.findNextStartPixel();if(this.isFinalPixel(e))return!1;var t=this.selectFrame(e);return t&&(t.id=Object(ce.a)(),t.fontName=this._fontName,t.imagedata=this._auxCanvas.getContext("2d").getImageData(t.x,t.y,t.width,t.height),this._listSelections.push(t)),!0}},{key:"selectFrame",value:function(e){var t={id:0,fontName:"",x:e.x,y:e.y,width:1,height:1,imagedata:null};return this.expandFromPixel(t),t}},{key:"expandFromPixel",value:function(e){for(var t=!1;!t;){0===this.expandFromAllDirections(e)&&(t=!0)}}},{key:"expandFromAllDirections",value:function(e){var t=0;return t+=this.expandToTheRight(e),t+=this.expandToTheBottom(e),t+=this.expandToTheLeft(e),t+=this.expandToTheTop(e)}},{key:"expandToTheTop",value:function(e){for(var t=0,a=!1;!a;){if(this.isLineEmptyToTheTop(e)){a=!0;break}t+=1,e.y-=1,e.height+=1}return t}},{key:"isLineEmptyToTheTop",value:function(e){var t=e.x,a=e.y-1;if(a<0)return!0;for(var i=t,n=t+e.width;i<n;i++)if(!this.isEmptyPixel(this.getPixel(i,a)))return!1;return!0}},{key:"expandToTheLeft",value:function(e){for(var t=0,a=!1;!a;){if(this.isLineEmptyToTheLeft(e)){a=!0;break}t+=1,e.x-=1,e.width+=1}return t}},{key:"isLineEmptyToTheLeft",value:function(e){var t=e.x-1,a=e.y;if(t<0)return!0;for(var i=a,n=a+e.height;i<n;i++)if(!this.isEmptyPixel(this.getPixel(t,i)))return!1;return!0}},{key:"expandToTheRight",value:function(e){for(var t=0,a=!1;!a;){if(this.isLineEmptyToTheRight(e)){a=!0;break}t+=1,e.width+=1}return t}},{key:"expandToTheBottom",value:function(e){for(var t=0,a=!1;!a;){if(this.isLineEmptyToTheBottom(e)){a=!0;break}t+=1,e.height+=1}return t}},{key:"isLineEmptyToTheBottom",value:function(e){var t=e.x,a=e.y+e.height;if(a>this._img.height)return!0;for(var i=t,n=t+e.width;i<n;i++)if(!this.isEmptyPixel(this.getPixel(i,a)))return!1;return!0}},{key:"isLineEmptyToTheRight",value:function(e){var t=e.x+e.width,a=e.y;if(t>this._img.width)return!0;for(var i=a,n=a+e.height;i<n;i++)if(!this.isEmptyPixel(this.getPixel(t,i)))return!1;return!0}},{key:"getPixel",value:function(e,t){return{x:e,y:t,red:this._rawData[4*(this._img.width*t+e)],green:this._rawData[4*(this._img.width*t+e)+1],blue:this._rawData[4*(this._img.width*t+e)+2],alpha:this._rawData[4*(this._img.width*t+e)+3]}}},{key:"isEmptyPixel",value:function(e){return e.red===this._refPixel.red&&e.blue===this._refPixel.blue&&e.green===this._refPixel.green&&e.alpha===this._refPixel.alpha}},{key:"findNextStartPixel",value:function(){return this.searchPixel()}},{key:"isFinalPixel",value:function(e){return void 0===e||e.x===this._img.width-1&&e.y===this._img.height-1}},{key:"searchPixel",value:function(){for(var e=0,t=this._img.height;e<t;e++)for(var a=0,i=this._img.width;a<i;a++){var n=this.getPixel(a,e);if(!this.isEmptyPixel(n)&&!this.isPixelInSelections(this._listSelections,n))return n}}},{key:"isPixelInSelections",value:function(e,t){return this.findSelectionOfPixel(e,t).length>0}},{key:"findSelectionOfPixel",value:function(e,t){return e.filter((function(e){var a=e.x,i=e.y,n=e.x+e.width,r=e.y+e.height;return t.x>=a&&t.x<=n&&t.y>=i&&t.y<=r&&e}))}}]),e}(),ue=function(){function e(){Object(h.a)(this,e),this._text="",this._code=-1,this._frame={x:0,y:0,w:0,h:0},this._sourceSize={w:0,h:0},this._spriteSourceSize={x:0,y:0,w:0,h:0},this._image=null,this._rotated=!1,this._xoffset=0,this._yoffset=0,this._xadvance=0}return Object(c.a)(e,[{key:"rotated",set:function(e){this._rotated=e},get:function(){return this._rotated}},{key:"frame",set:function(e){this._frame=e},get:function(){return this._frame}},{key:"sourceSize",set:function(e){this._sourceSize=e},get:function(){return this._sourceSize}},{key:"spriteSourceSize",set:function(e){this._spriteSourceSize=e},get:function(){return this._spriteSourceSize}},{key:"image",set:function(e){this._image=e},get:function(){return this._image}},{key:"text",set:function(e){this._text=e,this._code=e.charCodeAt(0)},get:function(){return this._text}},{key:"xadvance",get:function(){return this._xadvance},set:function(e){this._xadvance=e}},{key:"xoffset",get:function(){return this._xoffset},set:function(e){this._xoffset=e}},{key:"yoffset",get:function(){return this._yoffset},set:function(e){this._yoffset=e}},{key:"code",get:function(){return this._code}}]),e}(),de=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,i){var n;return Object(h.a)(this,a),(n=t.call(this))._name=e.split(".").slice(0,-1).join("."),n._fileName=e,n._image=i,n._size=0,n._lineHeight=0,n._spaceWidth=0,n._tabWidth=0,n._monospace=!1,n._monospaceValue=0,n._characters={},n}return Object(c.a)(a,[{key:"getCharById",value:function(e){var t=null;return this._characters.hasOwnProperty(e)&&(t=this._characters[e]),t}},{key:"getCharByText",value:function(e){var t=null;for(var a in this._characters)this._characters.hasOwnProperty(a)&&this._characters[a].text===e&&(t=this._characters[a]);return t}},{key:"setCharMonospace",value:function(){for(var e in this._characters)this._characters.hasOwnProperty(e)&&(this._characters[e].xoffset=(this._monospaceValue-this._characters[e].frame.w)/2,this._characters[e].xadvance=this._monospaceValue+(this._monospaceValue-this._characters[e].frame.w)/2)}},{key:"characters",get:function(){return this._characters},set:function(e){var t,a=e.length,i=0,n=0;for(t=0;t<a;t++)this._characters[e[t].id]=new ue,this._characters[e[t].id].xadvance=e[t].width,i=e[t].width>i?e[t].width:i,n=e[t].height>n?e[t].height:n;this._monospaceValue=i,this._lineHeight=n,this._size=n,this._spaceWidth=20,this._tabWidth=30}},{key:"spaceWidth",get:function(){return this._spaceWidth},set:function(e){this._spaceWidth=e}},{key:"tabWidth",get:function(){return this._tabWidth},set:function(e){this._tabWidth=e}},{key:"monospace",get:function(){return this._monospace},set:function(e){this._monospace=e}},{key:"monospaceValue",get:function(){return this._monospaceValue},set:function(e){this._monospaceValue=e}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(e){this._lineHeight=e}},{key:"size",get:function(){return this._size},set:function(e){this._size=e}},{key:"name",get:function(){return this._name}},{key:"fileName",get:function(){return this._fileName}}]),a}(f.a),pe=function(){function e(){Object(h.a)(this,e)}return Object(c.a)(e,null,[{key:"getAlpha",value:function(e,t,a,i){return e[i*(4*t)+4*a+3]}},{key:"getLeftSpace",value:function(e,t,a){var i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(i=0;i<t;i++)for(var r=0;r<a;r++)if(this.getAlpha(e,t,i,r)>n)return i;return 0}},{key:"getRightSpace",value:function(e,t,a){var i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(i=t-1;i>=0;i--)for(var r=0;r<a;r++)if(this.getAlpha(e,t,i,r)>n)return t-i-1;return 0}},{key:"getTopSpace",value:function(e,t,a){var i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(i=0;i<a;i++)for(var r=0;r<t;r++)if(this.getAlpha(e,t,r,i)>n)return i;return 0}},{key:"getBottomSpace",value:function(e,t,a){var i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(i=a-1;i>=0;i--)for(var r=0;r<t;r++)if(this.getAlpha(e,t,r,i)>n)return a-i-1;return 0}},{key:"trim",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=document.createElement("canvas"),n=i.getContext("2d"),r=Object(o.a)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value,h=s.image;i.width=h.width,i.height=h.height,n.clearRect(0,0,h.width,h.height),n.drawImage(h,0,0,h.width,h.height,0,0,h.width,h.height);var c=n.getImageData(0,0,h.width,h.height).data,l={left:0,right:0,top:0,bottom:0};l.left=this.getLeftSpace(c,h.width,h.height,a),l.left!==h.width?(l.right=this.getRightSpace(c,h.width,h.height,a),l.top=this.getTopSpace(c,h.width,h.height,a),l.bottom=this.getBottomSpace(c,h.width,h.height,a),(l.left>0||l.right>0||l.top>0||l.bottom>0)&&(s.trimmed=!0,s.spriteSourceSize.x=l.left,s.spriteSourceSize.y=l.top,s.spriteSourceSize.w=h.width-l.left-l.right,s.spriteSourceSize.h=h.height-l.top-l.bottom)):(s.trimmed=!0,s.spriteSourceSize.x=0,s.spriteSourceSize.y=0,s.spriteSourceSize.w=1,s.spriteSourceSize.h=1),s.trimmed&&(s.frame.w=s.spriteSourceSize.w,s.frame.h=s.spriteSourceSize.h)}}catch(u){r.e(u)}finally{r.f()}}}]),e}(),fe=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(h.a)(this,e),this._buffer=document.createElement("canvas"),this.width=0,this.height=0,this.render(t,a)}return Object(c.a)(e,[{key:"render",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._buffer.getContext("2d"),n=i.imageSmoothingEnabled;i.imageSmoothingEnabled=!a.disableSmoothing;var r=e.getSize(t,a),s=r.width,h=r.height;this.width=s,this.height=h,this._buffer.width=s,this._buffer.height=h,i.clearRect(0,0,s,h);var c,l=Object(o.a)(t);try{for(l.s();!(c=l.n()).done;){var u=c.value;this.renderItem(i,u,a)}}catch(d){l.e(d)}finally{l.f()}i.imageSmoothingEnabled=n}},{key:"scale",value:function(e){if(1===e)return this._buffer;var t=document.createElement("canvas");return t.width=Math.round(this._buffer.width*e)||1,t.height=Math.round(this._buffer.height*e)||1,t.getContext("2d").drawImage(this._buffer,0,0,this._buffer.width,this._buffer.height,0,0,t.width,t.height),t}},{key:"renderExtrude",value:function(e,t,a){if(a.extrude){var i=e.imageSmoothingEnabled;e.imageSmoothingEnabled=!1;var n=t.frame.x,r=t.frame.y;t.rotated&&(n=0,r=0);var s=t.image;e.drawImage(s,0,0,1,1,n-a.extrude,r-a.extrude,a.extrude,a.extrude),e.drawImage(s,0,t.sourceSize.h-1,1,1,n-a.extrude,r+t.frame.h,a.extrude,a.extrude),e.drawImage(s,t.sourceSize.w-1,0,1,1,n+t.frame.w,r-a.extrude,a.extrude,a.extrude),e.drawImage(s,t.sourceSize.w-1,t.sourceSize.h-1,1,1,n+t.frame.w,r+t.frame.h,a.extrude,a.extrude),e.drawImage(s,0,t.spriteSourceSize.y,1,t.spriteSourceSize.h,n-a.extrude,r,a.extrude,t.frame.h),e.drawImage(s,t.sourceSize.w-1,t.spriteSourceSize.y,1,t.spriteSourceSize.h,n+t.frame.w,r,a.extrude,t.frame.h),e.drawImage(s,t.spriteSourceSize.x,0,t.spriteSourceSize.w,1,n,r-a.extrude,t.frame.w,a.extrude),e.drawImage(s,t.spriteSourceSize.x,t.sourceSize.h-1,t.spriteSourceSize.w,1,n,r+t.frame.h,t.frame.w,a.extrude),e.imageSmoothingEnabled=i}}},{key:"renderItem",value:function(e,t,a){if(!t.skipRender){var i=t.image;t.rotated?(e.save(),e.translate(t.frame.x+t.frame.h,t.frame.y),e.rotate(Math.PI/2),this.renderExtrude(e,t,a),e.drawImage(i,t.spriteSourceSize.x,t.spriteSourceSize.y,t.spriteSourceSize.w,t.spriteSourceSize.h,0,0,t.frame.w,t.frame.h),e.restore()):(this.renderExtrude(e,t,a),e.drawImage(i,t.spriteSourceSize.x,t.spriteSourceSize.y,t.spriteSourceSize.w,t.spriteSourceSize.h,t.frame.x,t.frame.y,t.frame.w,t.frame.h))}}},{key:"buffer",get:function(){return this._buffer}}],[{key:"getSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.width||0,i=t.height||0,n=t.padding||0,r=t.extrude||0;if(!t.fixedSize){a=0,i=0;var s,h=Object(o.a)(e);try{for(h.s();!(s=h.n()).done;){var c=s.value,l=c.frame.x+c.frame.w,u=c.frame.y+c.frame.h;c.rotated&&(l=c.frame.x+c.frame.h,u=c.frame.y+c.frame.w),l>a&&(a=l),u>i&&(i=u)}}catch(g){h.e(g)}finally{h.f()}a+=n+r,i+=n+r}if(t.powerOfTwo){var d=Math.round(Math.log(a)/Math.log(2)),p=Math.round(Math.log(i)/Math.log(2)),f=Math.pow(2,d),m=Math.pow(2,p);f<a&&(f=Math.pow(2,d+1)),m<i&&(m=Math.pow(2,p+1)),a=f,i=m}return{width:a,height:i}}}]),e}(),me=function(){function e(){Object(h.a)(this,e)}return Object(c.a)(e,null,[{key:"detectIdentical",value:function(e){for(var t=[],a=0;a<e.length;a++)for(var i=e[a],n=a+1;n<e.length;n++){var r=e[n];i.image._base64===r.image._base64&&t.indexOf(r)<0&&(r.identical=i,t.push(r))}for(var s=0,o=t;s<o.length;s++){var h=o[s];e.splice(e.indexOf(h),1)}return{rects:e,identical:t}}},{key:"applyIdentical",value:function(e,t){var a,i=[],n=[],r=Object(o.a)(t);try{for(r.s();!(a=r.n()).done;){var s=a.value,h=e.indexOf(s.identical);if(h>=0){var c=e[h],l=Object.assign({},c);l.name=s.name,l.image=s.image,l.originalFile=s.file,l.skipRender=!0,n.push(s),i.push(l)}}}catch(v){r.e(v)}finally{r.f()}for(var u=0,d=n;u<d.length;u++){var p=d[u];t.splice(t.indexOf(p),1)}for(var f=0,m=i;f<m.length;f++){var g=m[f];g.cloned=!0,e.push(g)}return e}},{key:"pack",value:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=[],h=i.padding||0,c=i.extrude||0,l=0,u=0,d=0,p=0,f=i.alphaThreshold||0;f>255&&(f=255);var m,g=Object.keys(a).sort(),v=Object(o.a)(g);try{for(v.s();!(m=v.n()).done;){var b=m.value,y=a[b];l+=y.width,u+=y.height,y.width>d&&(d=y.width+2*h+2*c),y.height>p&&(p=y.height+2*h+2*c),s.push({frame:{x:0,y:0,w:y.width,h:y.height},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:y.width,h:y.height},sourceSize:{w:y.width,h:y.height},charId:b,file:y._fontName,image:y})}}catch(K){v.e(K)}finally{v.f()}var k=i.width||0,x=i.height||0;if(k||(k=l),x||(x=u),i.powerOfTwo){var w=Math.round(Math.log(k)/Math.log(2)),O=Math.round(Math.log(x)/Math.log(2)),_=Math.pow(2,w),S=Math.pow(2,O);_<k&&(_=Math.pow(2,w+1)),S<x&&(S=Math.pow(2,O+1)),k=_,x=S}if(k<d||x<p)r&&(console.error("INVALID_SIZE_ERROR",d,p),r({}));else{i.allowTrim&&pe.trim(s,f);var N,C=Object(o.a)(s);try{for(C.s();!(N=C.n()).done;){var E=N.value;E.frame.w+=2*h+2*c,E.frame.h+=2*h+2*c}}catch(K){C.e(K)}finally{C.f()}var F=[];if(i.detectIdentical){var M=e.detectIdentical(s);s=M.rects,F=M.identical}var j,P,T=function(){var e,t=[],a=Object(o.a)(q);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(i!==V)for(var n in i.methods)t.push({packerClass:i,packerMethod:i.methods[n],allowRotation:!1}),t.push({packerClass:i,packerMethod:i.methods[n],allowRotation:!0})}}catch(K){a.e(K)}finally{a.f()}return t},D=i.packer||L,R=i.packerMethod||L.methods.BestShortSideFit,B=D===V?T():[{packerClass:D,packerMethod:R,allowRotation:i.allowRotation}],z=1/0,I=0,A=0,H=Object(o.a)(s);try{for(H.s();!(P=H.n()).done;){var W=P.value;A+=W.sourceSize.w*W.sourceSize.h}}catch(K){H.e(K)}finally{H.f()}var U,G=Object(o.a)(B);try{var X=function(){for(var a=U.value,n=[],r=0,l=B.length>1?s.map((function(e){return Object.assign({},e,{frame:Object.assign({},e.frame),spriteSourceSize:Object.assign({},e.spriteSourceSize),sourceSize:Object.assign({},e.sourceSize)})})):s,u=B.length>1?F.map((function(e){var t,a=Object(o.a)(l);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(e.identical.image._base64==i.image._base64)return Object.assign({},e,{identical:i})}}catch(K){a.e(K)}finally{a.f()}})):F;l.length;){var d,p=new a.packerClass(k,x,a.allowRotation).pack(l,a.packerMethod),f=Object(o.a)(p);try{for(f.s();!(d=f.n()).done;){var m=d.value;m.frame.x+=h+c,m.frame.y+=h+c,m.frame.w-=2*h+2*c,m.frame.h-=2*h+2*c}}catch(K){f.e(K)}finally{f.f()}i.detectIdentical&&(p=e.applyIdentical(p,u)),n.push(p);var g,v=Object(o.a)(p);try{for(v.s();!(g=v.n()).done;){var b=g.value;t.removeRect(l,b.charId)}}catch(K){v.e(K)}finally{v.f()}var y=fe.getSize(p,i);r+=y.width*y.height}var w=n.length,O=A/r;(w<z||w===z&&O>I)&&(j=n,z=w,I=O)};for(G.s();!(U=G.n()).done;)X()}catch(K){G.e(K)}finally{G.f()}n&&n(j)}}},{key:"removeRect",value:function(e,t){for(var a=0;a<e.length;a++)if(e[a].charId===t)return void e.splice(a,1)}}]),e}(),ge=(a(38),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).onAtlasListChanged=i.onAtlasListChanged.bind(Object(l.a)(i)),i.onCharImageLoaded=i.onCharImageLoaded.bind(Object(l.a)(i)),i.onPackOptionsChanged=i.onPackOptionsChanged.bind(Object(l.a)(i)),i.startExport=i.startExport.bind(Object(l.a)(i)),i.onFontSelected=i.onFontSelected.bind(Object(l.a)(i)),i._bitmapFonts={},i._packResult=null,i._packCharas=null,i._packOptions={},i._spriteSplitter=new le,i._totalCharasToLoad=0,i._numCharasLoaded=0,i._selectedFont=null,O.on(m,i.onAtlasListChanged),O.on(v,i.onPackOptionsChanged),O.on(b,i.startExport),O.on(y,i.onFontSelected),i}return Object(c.a)(a,[{key:"onFontSelected",value:function(e){this._selectedFont=e.selectedFont,this._packCharas=this.getImageCharas(),this.doPack()}},{key:"onPackOptionsChanged",value:function(e){this._packOptions=e,e.selectedFont&&(this._selectedFont=e.selectedFont),this._packCharas=this.getImageCharas(),this.doPack()}},{key:"onAtlasListChanged",value:function(e){var t=[];for(var a in e)if(e.hasOwnProperty(a)){var i=e[a];if(!this._bitmapFonts.hasOwnProperty(a)){this._bitmapFonts[a]=new de(a,i);var n=this._spriteSplitter.split(i,a);this._totalCharasToLoad+=n.length,this._bitmapFonts[a].characters=n,t=t.concat(n)}}var r,s=document.createElement("canvas"),o=s.getContext("2d"),h=t.length;for(r=0;r<h;r++){s.width=t[r].imagedata.width,s.height=t[r].imagedata.height,o.putImageData(t[r].imagedata,0,0);var c=new Image;this._bitmapFonts[t[r].fontName].characters[t[r].id].image=c,c.addEventListener("load",this.onCharImageLoaded),c._base64=s.toDataURL(),c._id=t[r].id,c._fontName=t[r].fontName,c.width=t[r].imagedata.width,c.height=t[r].imagedata.height,c.src=s.toDataURL()}}},{key:"onCharImageLoaded",value:function(e){e.target.removeEventListener("load",this.onCharImageLoaded),this._numCharasLoaded++,this._numCharasLoaded===this._totalCharasToLoad&&(this._totalCharasToLoad=0,this._numCharasLoaded=0,this._selectedFont||(this._selectedFont=Object.keys(this._bitmapFonts)[0],this._packOptions.selectedFont=this._selectedFont,O.emit(y,{selectedFont:this._selectedFont})),this._packCharas=this.getImageCharas(),this.doPack())}},{key:"getImageCharas",value:function(){if(this._selectedFont){var e={};if(this._packOptions.multiFont)for(var t in this._bitmapFonts)for(var a in this._bitmapFonts[t].characters)this._bitmapFonts[t].characters.hasOwnProperty(a)&&(e[a]=this._bitmapFonts[t].characters[a].image);else for(var i in this._bitmapFonts[this._selectedFont].characters)this._bitmapFonts[this._selectedFont].characters.hasOwnProperty(i)&&(e[i]=this._bitmapFonts[this._selectedFont].characters[i].image);return e}}},{key:"updateBitmapFonts",value:function(e){var t,a=e.length;for(t=0;t<a;t++){var i=e[t].file,n=e[t].charId;this._bitmapFonts[i].characters[n].frame.x=e[t].frame.x,this._bitmapFonts[i].characters[n].frame.y=e[t].frame.y,this._bitmapFonts[i].characters[n].frame.w=e[t].frame.w,this._bitmapFonts[i].characters[n].frame.h=e[t].frame.h,this._bitmapFonts[i].characters[n].sourceSize.w=e[t].sourceSize.w,this._bitmapFonts[i].characters[n].sourceSize.h=e[t].sourceSize.h,this._bitmapFonts[i].characters[n].spriteSourceSize.x=e[t].spriteSourceSize.x,this._bitmapFonts[i].characters[n].spriteSourceSize.y=e[t].spriteSourceSize.y,this._bitmapFonts[i].characters[n].spriteSourceSize.w=e[t].spriteSourceSize.w,this._bitmapFonts[i].characters[n].spriteSourceSize.h=e[t].spriteSourceSize.h,this._bitmapFonts[i].characters[n].rotated=e[t].rotated}}},{key:"doPack",value:function(){var e=this;null!=this._packCharas&&(Object.keys(this._packCharas).length>0&&me.pack(this._packCharas,this._packOptions,(function(t){e._packResult=[];var a,i=Object(o.a)(t);try{for(i.s();!(a=i.n()).done;){var n=a.value,r=new fe(n,e._packOptions);e.updateBitmapFonts(n),e._packResult.push({buffer:r.buffer,renderer:r,multifont:e._packOptions.multiFont,selectedFont:e._selectedFont})}}catch(s){i.e(s)}finally{i.f()}O.emit(g,e._packResult)}),null))}},{key:"startExport",value:function(){try{oe.startExporter(this._packResult[0].buffer,this._bitmapFonts,this._packOptions)}catch(e){console.error("Error exporting")}}},{key:"render",value:function(){return n.a.createElement("div",{className:"app-main"},n.a.createElement("div",{className:"app-wrapper"},n.a.createElement(_,null),n.a.createElement("div",{className:"app-layout"},n.a.createElement(j,null),n.a.createElement(he,{bitmapfonts:this._bitmapFonts}),n.a.createElement(C,{bitmapfonts:this._bitmapFonts}))))}}]),a}(i.Component));s.a.render(n.a.createElement(ge,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.a84de69c.chunk.js.map